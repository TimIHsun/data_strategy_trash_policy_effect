---
title: "trash-policy"
author: "邱奕勳"
date: "2020/5/14"
output: html_document
---

```{r}
library(dplyr); library(stringr); library(ggplot2); library(plotly); library(lubridate); library(readr); library(tidyr); library(showtext)

font_add("QYuan","cwTeXQYuan-Medium.ttf") # 新增字體
showtext_auto(enable=TRUE) #啟用字體
theme_set(theme_classic())
knitr::opts_chunk$set(out.width='80%', fig.asp=.75, fig.align='center', fig.showtext=T)
```

#資料
```{r}
NewTP <- read_csv("NewTP.csv", col_types = cols(序號 = col_skip()))
Taoyuan <- read_csv("Taoyuan.csv", col_types = cols(序號 = col_skip()))
Taipei <- read_csv("Taipei.csv", col_types = cols(序號 = col_skip()))
```

#處理時間
```{r}
NewTP$統計期 %>% str_replace_all(c("年"="-","月"="-01")) -> NewTP$統計期
str_split(NewTP$統計期, "-") -> NewTPYearMonth

for (i in 1:length(NewTPYearMonth)){
  as.integer(NewTPYearMonth[[i]][[1]])+1911 -> NewTPYearMonth[[i]][[1]]
  str_c(NewTPYearMonth[[i]], collapse = "-") -> NewTPYearMonth[[i]] 
}


NewTP$統計期 <- NewTPYearMonth %>% ymd()
```
```{r}
Taoyuan$統計期 %>% str_replace_all(c("年"="-","月"="-01")) -> Taoyuan$統計期
str_split(Taoyuan$統計期, "-") -> TaoyuanYearMonth

for (i in 1:length(TaoyuanYearMonth)){
  as.integer(TaoyuanYearMonth[[i]][[1]])+1911 -> TaoyuanYearMonth[[i]][[1]]
  str_c(TaoyuanYearMonth[[i]], collapse = "-") -> TaoyuanYearMonth[[i]] 
}
Taoyuan$統計期 <- TaoyuanYearMonth %>% ymd()
```

```{r}
Taipei$統計期 %>% str_replace_all(c("年"="-","月"="-01")) -> Taipei$統計期
str_split(Taipei$統計期, "-") -> TaipeiYearMonth

for (i in 1:length(TaipeiYearMonth)){
  as.integer(TaipeiYearMonth[[i]][[1]])+1911 -> TaipeiYearMonth[[i]][[1]]
  str_c(TaipeiYearMonth[[i]], collapse = "-") -> TaipeiYearMonth[[i]] 
}

Taipei$統計期 <- TaipeiYearMonth %>% ymd()
```


```{r}
Taoyuan %>% ggplot() + 
  geom_line(aes(x= Taoyuan$統計期, y= Taoyuan$`平均每人每日一般廢棄物產生量 (公斤)`))+
  geom_line(
    data = NewTP ,
    aes(x= NewTP$統計期, y= NewTP$`平均每人每日一般廢棄物產生量 (公斤)`), color = "red"
            )+
  geom_line(
    data = Taipei ,
    aes(x= Taipei$統計期, y= Taipei$`平均每人每日一般廢棄物產生量 (公斤)`), color = "blue"
            )+
  geom_vline(xintercept = ymd("2010-01-01"))+labs(x="統計期(年月)", y="平均每人每日")

```

